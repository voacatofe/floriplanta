import { PrismaClient } from '../lib/generated/prisma/index.js';

const prisma = new PrismaClient();

async function main() {
  console.log('Iniciando o seeding do blog...');

  // Verificar se j√° existe um usu√°rio admin
  const adminUser = await prisma.user.findFirst({
    where: { email: 'admin@floriplanta.com.br' }
  });

  if (!adminUser) {
    console.log('Usu√°rio admin n√£o encontrado. Execute primeiro o seedAdmin.mjs');
    return;
  }

  // Criar categorias
  const categories = [
    { name: 'Not√≠cias da Floriplanta', slug: 'noticias-floriplanta' },
    { name: 'Cannabis Medicinal', slug: 'cannabis-medicinal' },
    { name: 'Pesquisas e Estudos', slug: 'pesquisas-estudos' },
    { name: 'Sa√∫de e Bem-estar', slug: 'saude-bem-estar' },
    { name: 'Legisla√ß√£o', slug: 'legislacao' },
    { name: 'Comunidade', slug: 'comunidade' },
    { name: 'Eventos', slug: 'eventos' }
  ];

  console.log('Criando categorias...');
  for (const category of categories) {
    await prisma.category.upsert({
      where: { slug: category.slug },
      update: {},
      create: category
    });
  }

  // Criar tags
  const tags = [
    { name: 'CBD', slug: 'cbd' },
    { name: 'THC', slug: 'thc' },
    { name: 'Epilepsia', slug: 'epilepsia' },
    { name: 'Dor Cr√¥nica', slug: 'dor-cronica' },
    { name: 'Ansiedade', slug: 'ansiedade' },
    { name: 'Depress√£o', slug: 'depressao' },
    { name: 'Autismo', slug: 'autismo' },
    { name: 'Parkinson', slug: 'parkinson' },
    { name: 'Alzheimer', slug: 'alzheimer' },
    { name: 'C√¢ncer', slug: 'cancer' },
    { name: 'Fibromialgia', slug: 'fibromialgia' },
    { name: 'ANVISA', slug: 'anvisa' },
    { name: 'Prescri√ß√£o M√©dica', slug: 'prescricao-medica' },
    { name: 'Cultivo', slug: 'cultivo' },
    { name: '√ìleo de Cannabis', slug: 'oleo-cannabis' }
  ];

  console.log('Criando tags...');
  for (const tag of tags) {
    await prisma.tag.upsert({
      where: { slug: tag.slug },
      update: {},
      create: tag
    });
  }

  // Buscar categorias e tags criadas
  const createdCategories = await prisma.category.findMany();
  const createdTags = await prisma.tag.findMany();

  // Criar posts de exemplo
  const posts = [
    {
      title: 'Bem-vindos ao Blog da Floriplanta!',
      slug: 'bem-vindos-ao-blog',
      content: `# Bem-vindos ao Blog da Floriplanta!

√â com grande alegria que inauguramos nosso novo espa√ßo de conhecimento e troca. Aqui voc√™ encontrar√° artigos, not√≠cias, pesquisas e hist√≥rias sobre o universo da cannabis medicinal.

## Nossa Miss√£o

Nosso objetivo √© democratizar o acesso √† informa√ß√£o sobre cannabis medicinal, sempre baseada em evid√™ncias cient√≠ficas e experi√™ncias reais de nossa comunidade.

## O que voc√™ encontrar√° aqui:

- **Not√≠cias atualizadas** sobre legisla√ß√£o e regulamenta√ß√£o
- **Pesquisas cient√≠ficas** traduzidas e explicadas de forma acess√≠vel
- **Hist√≥rias de pacientes** e suas jornadas de tratamento
- **Guias pr√°ticos** sobre como acessar tratamentos
- **Eventos e webinars** da nossa comunidade

## Participe!

Este √© um espa√ßo de todos n√≥s. Compartilhe suas experi√™ncias, tire suas d√∫vidas e ajude a construir uma comunidade mais informada e unida.

Juntos, somos mais fortes! üíö`,
      imageUrl: '/images/blog/bem-vindos-blog.svg',
      published: true,
      categories: ['noticias-floriplanta'],
      tags: ['comunidade']
    },
    {
      title: 'Cannabis Medicinal: O que a Ci√™ncia Diz',
      slug: 'cannabis-medicinal-ciencia',
      content: `# Cannabis Medicinal: O que a Ci√™ncia Diz

A cannabis medicinal tem ganhado cada vez mais reconhecimento cient√≠fico. Neste artigo, exploramos as principais evid√™ncias cient√≠ficas sobre seus benef√≠cios terap√™uticos.

## Componentes Ativos

### CBD (Canabidiol)
O CBD √© um dos principais compostos da cannabis, conhecido por suas propriedades:
- Anti-inflamat√≥rias
- Anticonvulsivantes
- Ansiol√≠ticas
- Neuroprotetoras

### THC (Tetrahidrocanabinol)
O THC possui propriedades:
- Analg√©sicas
- Antiem√©ticas
- Estimulantes do apetite
- Relaxantes musculares

## Condi√ß√µes Tratadas

Estudos cient√≠ficos demonstram efic√°cia no tratamento de:

1. **Epilepsia refrat√°ria**
2. **Dor cr√¥nica**
3. **Espasticidade na esclerose m√∫ltipla**
4. **N√°useas e v√¥mitos em quimioterapia**
5. **Transtornos de ansiedade**

## Conclus√£o

A evid√™ncia cient√≠fica continua crescendo, mostrando o potencial terap√™utico da cannabis medicinal para diversas condi√ß√µes.`,
      imageUrl: '/images/blog/cannabis-ciencia.svg',
      published: true,
      categories: ['cannabis-medicinal', 'pesquisas-estudos'],
      tags: ['cbd', 'thc', 'pesquisa']
    },
    {
      title: 'Guia Completo: Como Acessar Cannabis Medicinal no Brasil',
      slug: 'guia-acesso-cannabis-medicinal-brasil',
      content: `# Guia Completo: Como Acessar Cannabis Medicinal no Brasil

Navegar pelo processo de acesso √† cannabis medicinal pode parecer complexo. Este guia simplifica todos os passos necess√°rios.

## Passo 1: Consulta M√©dica

- Procure um m√©dico especialista na sua condi√ß√£o
- Discuta todas as op√ß√µes de tratamento
- Solicite a prescri√ß√£o m√©dica espec√≠fica

## Passo 2: Documenta√ß√£o Necess√°ria

### Para a ANVISA:
- Receita m√©dica em duas vias
- Relat√≥rio m√©dico detalhado
- Exames que comprovem a condi√ß√£o
- Termo de responsabilidade

## Passo 3: Solicita√ß√£o na ANVISA

1. Acesse o portal da ANVISA
2. Preencha o formul√°rio online
3. Anexe toda a documenta√ß√£o
4. Pague a taxa (quando aplic√°vel)
5. Aguarde a an√°lise (at√© 10 dias √∫teis)

## Passo 4: Importa√ß√£o ou Compra

### Produtos Importados:
- Autoriza√ß√£o de importa√ß√£o
- Compra em farm√°cias autorizadas no exterior
- Declara√ß√£o na Receita Federal

### Produtos Nacionais:
- Compra em farm√°cias autorizadas
- Apresenta√ß√£o da autoriza√ß√£o ANVISA

## Dicas Importantes

- Mantenha sempre a documenta√ß√£o em dia
- Renove as autoriza√ß√µes antes do vencimento
- Guarde todos os comprovantes
- Mantenha contato regular com seu m√©dico

## Apoio da Floriplanta

Nossa associa√ß√£o oferece:
- Orienta√ß√£o jur√≠dica
- Suporte no processo
- Rede de m√©dicos parceiros
- Comunidade de apoio

Lembre-se: voc√™ n√£o est√° sozinho nesta jornada!`,
      imageUrl: '/images/blog/guia-acesso-cannabis.svg',
      published: true,
      categories: ['legislacao', 'comunidade'],
      tags: ['anvisa', 'prescricao-medica', 'guia']
    },
    {
      title: 'Hist√≥rias Reais: Como a Cannabis Mudou Minha Vida',
      slug: 'historias-reais-cannabis-mudou-vida',
      content: `# Hist√≥rias Reais: Como a Cannabis Mudou Minha Vida

*Depoimento de Maria Silva, m√£e de Jo√£o, 8 anos, diagnosticado com epilepsia refrat√°ria*

## O In√≠cio da Jornada

Quando Jo√£o tinha 3 anos, come√ßaram as crises epil√©pticas. Eram mais de 100 crises por dia. Nenhum medicamento tradicional funcionava.

## A Descoberta

Foi atrav√©s de um grupo de m√£es que conheci a cannabis medicinal. No in√≠cio, tinha muito medo e preconceito.

## O Primeiro Tratamento

Com a prescri√ß√£o m√©dica e autoriza√ß√£o da ANVISA, come√ßamos com √≥leo de CBD. Os resultados foram:

- **Primeira semana**: Redu√ß√£o de 30% nas crises
- **Primeiro m√™s**: Redu√ß√£o de 70% nas crises
- **Terceiro m√™s**: Jo√£o teve apenas 2 crises

## Mudan√ßas na Qualidade de Vida

### Para Jo√£o:
- Voltou a brincar
- Melhorou na escola
- Recuperou o sorriso
- Dorme melhor

### Para a Fam√≠lia:
- Menos ansiedade
- Noites de sono
- Esperan√ßa renovada
- Vida social retomada

## Desafios Enfrentados

- Preconceito de familiares
- Dificuldades burocr√°ticas
- Custo do tratamento
- Falta de informa√ß√£o m√©dica

## O Apoio da Comunidade

A Floriplanta foi fundamental:
- Orienta√ß√£o jur√≠dica
- Suporte emocional
- Rede de contatos
- Informa√ß√µes atualizadas

## Mensagem de Esperan√ßa

"Se voc√™ est√° passando por algo similar, n√£o desista. A cannabis medicinal pode ser a resposta que voc√™ procura. Busque informa√ß√£o, encontre m√©dicos especializados e conte com o apoio da nossa comunidade."

---

*Esta √© uma das muitas hist√≥rias de transforma√ß√£o em nossa comunidade. Se voc√™ tem uma hist√≥ria para compartilhar, entre em contato conosco.*`,
      imageUrl: '/images/blog/historias-reais.svg',
      published: true,
      categories: ['comunidade', 'saude-bem-estar'],
      tags: ['epilepsia', 'cbd', 'historias-reais', 'criancas']
    },
    {
      title: 'Novidades na Legisla√ß√£o: RDC 570/2023 da ANVISA',
      slug: 'novidades-legislacao-rdc-570-2023',
      content: `# Novidades na Legisla√ß√£o: RDC 570/2023 da ANVISA

A ANVISA publicou a RDC 570/2023, trazendo importantes atualiza√ß√µes para o acesso √† cannabis medicinal no Brasil.

## Principais Mudan√ßas

### 1. Simplifica√ß√£o do Processo
- Redu√ß√£o de documentos necess√°rios
- Processo mais √°gil
- Menos burocracia

### 2. Novos Produtos Autorizados
- Amplia√ß√£o da lista de produtos
- Novas concentra√ß√µes dispon√≠veis
- Diferentes formas farmac√™uticas

### 3. Prescri√ß√£o M√©dica
- Qualquer m√©dico pode prescrever
- N√£o precisa mais ser especialista
- Receita simples para alguns casos

## Impactos Positivos

### Para Pacientes:
- Acesso mais r√°pido
- Menor custo burocr√°tico
- Mais op√ß√µes de tratamento

### Para M√©dicos:
- Processo mais simples
- Menos responsabilidade burocr√°tica
- Foco no tratamento

### Para Fam√≠lias:
- Menos stress
- Economia de tempo
- Maior seguran√ßa jur√≠dica

## O que Muda na Pr√°tica

### Antes da RDC 570/2023:
1. Consulta com especialista obrigat√≥ria
2. Relat√≥rio m√©dico extenso
3. M√∫ltiplos exames
4. Processo demorado (at√© 30 dias)

### Depois da RDC 570/2023:
1. Qualquer m√©dico pode prescrever
2. Relat√≥rio simplificado
3. Exames essenciais apenas
4. Processo mais r√°pido (at√© 10 dias)

## Pr√≥ximos Passos

A ANVISA continua trabalhando em:
- Regulamenta√ß√£o do cultivo
- Amplia√ß√£o de produtos nacionais
- Redu√ß√£o de custos
- Educa√ß√£o m√©dica

## Como a Floriplanta Pode Ajudar

Nossa associa√ß√£o oferece:
- Orienta√ß√£o sobre as novas regras
- Suporte jur√≠dico atualizado
- Rede de m√©dicos capacitados
- Acompanhamento do processo

## Conclus√£o

A RDC 570/2023 representa um grande avan√ßo para o acesso √† cannabis medicinal no Brasil. Estamos caminhando para um futuro mais acess√≠vel e humanizado.

*Mantenha-se informado atrav√©s do nosso blog e redes sociais para n√£o perder nenhuma atualiza√ß√£o importante.*`,
      imageUrl: '/images/blog/legislacao-rdc-570.svg',
      published: true,
      categories: ['legislacao', 'noticias-floriplanta'],
      tags: ['anvisa', 'rdc-570', 'legislacao', 'acesso']
    }
  ];

  console.log('Criando posts...');
  for (const postData of posts) {
    const { categories: categoryNames, tags: tagNames, ...post } = postData;
    
    // Verificar se o post j√° existe
    const existingPost = await prisma.post.findUnique({
      where: { slug: post.slug }
    });

    if (existingPost) {
      console.log(`Post '${post.title}' j√° existe, pulando...`);
      continue;
    }

    // Encontrar categorias e tags
    const postCategories = createdCategories.filter(cat => 
      categoryNames.includes(cat.slug)
    );
    const postTags = createdTags.filter(tag => 
      tagNames.includes(tag.slug)
    );

    await prisma.post.create({
      data: {
        ...post,
        authorId: adminUser.id,
        categories: {
          connect: postCategories.map(cat => ({ id: cat.id }))
        },
        tags: {
          connect: postTags.map(tag => ({ id: tag.id }))
        }
      }
    });

    console.log(`Post '${post.title}' criado com sucesso!`);
  }

  console.log('Seeding do blog conclu√≠do com sucesso!');
}

main()
  .catch((e) => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });